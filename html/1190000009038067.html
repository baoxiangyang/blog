ebpack+react搭配使用</p>
<p>首先教大家2个新技能</p>
<ul>
<li>
<p>1.按照正常github地址情况下，你的github本身不能访问目录。</p>
<ul><li><p>例如要访问vue-demo下的vueCpu文件夹:<a href="https://github.com/holidaying/vue-demo/vueCpu">https://github.com/holidaying...</a>（显示404）但是在目录上加上tree/master/：<a href="https://github.com/holidaying/vue-demo/tree/master/vueCpu">https://github.com/holidaying...</a> （master是分支名）就可以访问。</p></li></ul>
</li>
<li>
<p>2.github目录的制作</p>
<ul>
<li><p>明确一个问题。一个标题就是一个目录名称</p></li>
<li><p>写法[xx](#题目名称)#不能少</p></li>
<li><p>题目名称的写法规则：abc demo-&gt; abc-demo,Abc-Demo-&gt;abc-demo。会忽略:和()即就是题目中所有可见字符的空格均用-连接，中、英文空格要分开，中文空格对应中文-。并且全为小写</p></li>
</ul>
</li>
</ul>
<h2>步骤</h2>
<p>首先，install <a href="https://www.npmjs.com/package/webpack">Webpack</a> 和 <a href="https://www.npmjs.com/package/webpack-dev-server">webpack-dev-server</a>.</p>
<pre><code>$ npm i -g webpack webpack-dev-server</code></pre>
<pre><code># Linux &amp; Mac
$ git clone git@github.com:holidaying/webpack-demos.git

# Windows
$ git clone https://github.com/holidaying/webpack-demos.git
:
$ cd webpack-demos
$ npm install</code></pre>
<p>接下来就可以进行demo演示了.</p>
<pre><code>$ cd demo01
$ webpack-dev-server</code></pre>
<p>用浏览器访问 <a href="http://127.0.0.1:8080.">http://127.0.0.1:8080.</a></p>
<h2>什么是webpack？</h2>
<p>Webpack 是前端的打包工具类类似于 Grunt and Gulp.但是有区别，因为它是模块化构建机制，Webpack可以看做是模块打包机：它做的事情是，分析你的项目结构，找到JavaScript模块以及其它的一些浏览器不能直接运行的拓展语言（Scss，TypeScript等），并将其打包为合适的格式以供浏览器使用。<br><code>WebPack和Grunt以及Gulp相比有什么特性</code><br>其实Webpack和另外两个并没有太多的可比性，Gulp/Grunt是一种能够优化前端的开发流程的工具，而WebPack是一种模块化的解决方案，不过Webpack的优点使得Webpack可以替代Gulp/Grunt类的工具。<br>Grunt和Gulp的工作方式是：在一个配置文件中，指明对某些文件进行类似编译，组合，压缩等任务的具体步骤，这个工具之后可以自动替你完成这些任务。<br><a href="http://webpack.github.io/docs/what-is-webpack.html">更多信息</a>.</p>
<pre><code>
$ webpack main.js bundle.js</code></pre>
<p>它的配置文件是 <code>webpack.config.js</code>.</p>
<pre><code class="javascript">// webpack.config.js
module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  }
};</code></pre>
<p>有了<code>webpack.config.js</code>,你可以不带参数使用webpack</p>
<pre><code>$ webpack</code></pre>
<p>一些命令行选项你应该知道。</p>
<ul>
<li><p><code>webpack</code> – 构建文件</p></li>
<li><p><code>webpack -p</code> – 发布</p></li>
<li><p><code>webpack --watch</code> – 监听项目</p></li>
<li><p><code>webpack -d</code> – 包含 source maps方便调试</p></li>
<li><p><code>webpack --colors</code> – 让打包界面更好看</p></li>
</ul>
<p>去构建你的项目, 你可以把启动项写进package.json</p>
<pre><code class="javascript">// package.json
{
  // ...
  "scripts": {
    "dev": "webpack-dev-server --devtool eval --progress --colors",
    "deploy": "NODE_ENV=production webpack -p"
  },
  // ...
}</code></pre>
<h2>目录</h2>
<ol>
<li><p><a>单文件入口</a></p></li>
<li><p><a>多文件入口</a></p></li>
<li><p><a>Babel-loader</a></p></li>
<li><p><a>CSS-loader</a></p></li>
<li><p><a>Image loader</a></p></li>
<li><p><a>CSS Module</a></p></li>
<li><p><a>UglifyJs Plugin插件</a></p></li>
<li><p><a>HTML Webpack Plugin and Open Browser Webpack Plugin</a></p></li>
<li><p><a>Environment flags环境变量</a></p></li>
<li><p><a>Code splitting代码分割</a></p></li>
<li><p><a>Code splitting with bundle-loader</a></p></li>
<li><p><a>Common chunk提取公共文件</a></p></li>
<li><p><a>Vendor chunk提取公共的第三方代码</a></p></li>
<li><p><a>externals全局变量</a></p></li>
<li><p><a>热模块替代/热更新</a></p></li>
<li><p><a>React router</a></p></li>
</ol>
<h2>Demo01: 单文件入口 (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo01">源码</a>)</h2>
<p>Webpack会入口文件进行打包成bundle.js.</p>
<p>例子, <code>main.js</code> 是单文件入口.</p>
<pre><code class="javascript">// main.js
document.write('&lt;h1&gt;Hello World&lt;/h1&gt;');</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;script type="text/javascript" src="bundle.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>Webpack follows <code>webpack.config.js</code> to build <code>bundle.js</code>.</p>
<pre><code class="javascript">// webpack.config.js
module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  }
};</code></pre>
<p>启动服务, 访问 <a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a> .</p>
<pre><code class="bash">$ webpack-dev-server</code></pre>
<h2>Demo02: 多文件入口(<a href="https://github.com/holidaying/webpack-demos/tree/master/demo02">源码</a>)</h2>
<p>多个入口文件，实用于多个页面的应用</p>
<pre><code class="javascript">// main1.js
document.write('&lt;h1&gt;Hello World&lt;/h1&gt;');

// main2.js
document.write('&lt;h2&gt;Hello Webpack&lt;/h2&gt;');</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;script src="bundle1.js"&gt;&lt;/script&gt;
    &lt;script src="bundle2.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">module.exports = {
  entry: {
    bundle1: './main1.js',
    bundle2: './main2.js'
  },
  output: {
    filename: '[name].js'
  }
};</code></pre>
<h2>Demo03: Babel-loader (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo03">源码</a>)</h2>
<p>通过使用不同的loader，webpack通过调用外部的脚本或工具可以对各种各样的格式的文件进行处理(<a href="http://webpack.github.io/docs/using-loaders.html">更多信息</a>). 例如, <a href="https://www.npmjs.com/package/babel-loader">Babel-loader</a> Babel其实是一个编译JavaScript的平台可以将 JSX/ES6 文件转换成浏览器可以识别的js文件. 官方文档<a href="http://webpack.github.io/docs/list-of-loaders.html">loaders</a>.</p>
<p><code>main.jsx</code> is a JSX 文件.</p>
<pre><code class="javascript">const React = require('react');
const ReactDOM = require('react-dom');

ReactDOM.render(
  &lt;h1&gt;Hello, world!&lt;/h1&gt;,
  document.querySelector('#wrapper')
);</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;div id="wrapper"&gt;&lt;/div&gt;
    &lt;script src="bundle.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">module.exports = {
  entry: './main.jsx',
  output: {
    filename: 'bundle.js'
  },
  module: {
    loaders:[
      {
        test: /\.js[x]?$/,
        exclude: /node_modules/,
        loader: 'babel-loader?presets[]=es2015&amp;presets[]=react'
      },
    ]
  }
};</code></pre>
<p>在 <code>webpack.config.js</code>, <code>module.loaders</code> 区域是用来分配loader的. 像上面的代码片段使用了 <code>babel-loader</code> 需要安装插件 <a href="https://www.npmjs.com/package/babel-preset-es2015">babel-preset-es2015</a> 和 <a href="https://www.npmjs.com/package/babel-preset-react">babel-preset-react</a> to 编译成 ES6 and React. 可以用query配置参数</p>
<pre><code class="javascript">module: {
  loaders: [
    {
      test: /\.jsx?$/,
      exclude: /node_modules/,
      loader: 'babel',
      query: {
        presets: ['es2015', 'react']
      }
    }
  ]
}</code></pre>
<h2>Demo04: CSS-loader (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo04">源码</a>)</h2>
<p>Webpack 允许你在js文件中require CSS , 通过 CSS-loader来预处理css文件.</p>
<p>main.js</p>
<pre><code class="javascript">require('./app.css');</code></pre>
<p>app.css</p>
<pre><code class="css">body {
  background-color: blue;
}</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;head&gt;
    &lt;script type="text/javascript" src="bundle.js"&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello World&lt;/h1&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  },
  module: {
    loaders:[
      { test: /\.css$/, loader: 'style-loader!css-loader' },
    ]
  }
};</code></pre>
<p>但是,你需要使用2中loaders来转换CSS 文件. 第一个是 <a href="https://www.npmjs.com/package/css-loader">CSS-loader</a> 来读取CSS文件, 另外一个是<a href="https://www.npmjs.com/package/style-loader">Style-loader</a> 是将style样式插入到html中。 中间用！连接</p>
<p>启动服务后, <code>index.html</code> 有内部样式.</p>
<pre><code class="html">&lt;head&gt;
  &lt;script type="text/javascript" src="bundle.js"&gt;&lt;/script&gt;
  &lt;style type="text/css"&gt;
    body {
      background-color: blue;
    }
  &lt;/style&gt;
&lt;/head&gt;</code></pre>
<h2>Demo05: Image loader (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo05">源码</a>)</h2>
<p>Webpack 允许你在js文件中require图片 , 通过 url-loader和file-loader来预处理图片文件.</p>
<p>main.js</p>
<pre><code class="javascript">var img1 = document.createElement("img");
img1.src = require("./small.png");
document.body.appendChild(img1);

var img2 = document.createElement("img");
img2.src = require("./big.png");
document.body.appendChild(img2);</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;script type="text/javascript" src="bundle.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  },
  module: {
    loaders:[
      { test: /\.(png|jpg)$/, loader: 'url-loader?limit=8192' }
    ]
  }
};</code></pre>
<p><a href="https://www.npmjs.com/package/url-loader">url-loader</a> 转换图片文件. 如果图片的大小小于 8192 bytes,它将会转成base64位的地址; 相反, 它就是普通地址. <br>参数前是用？连接的</p>
<p>启动服务后, <code>small.png</code> and <code>big.png</code> 将会有一下的地址.</p>
<pre><code class="html">&lt;img src="data:image/png;base64,iVBOR...uQmCC"&gt;
&lt;img src="4853ca667a2b8b8844eb2693ac1b2578.png"&gt;</code></pre>
<h2>Demo06: CSS Module (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo06">源码</a>)</h2>
<p><code>css-loader?modules</code> (the query parameter modules) enables the <a href="https://github.com/css-modules/css-modules">CSS Modules</a> spec.</p>
<p>CSS Module可以开启全局变量和局部变量，:global(...)表示全局变量，可以在全局中使用样式(<a href="https://css-modules.github.io/webpack-demo/">更多信息</a>)</p>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
&lt;body&gt;
  &lt;h1 class="h1"&gt;Hello World&lt;/h1&gt;
  &lt;h2 class="h2"&gt;Hello Webpack&lt;/h2&gt;
  &lt;div id="example"&gt;&lt;/div&gt;
  &lt;script src="./bundle.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>app.css</p>
<pre><code class="css">.h1 {
  color:red;
}

:global(.h2) {
  color: blue;
}</code></pre>
<p>main.jsx</p>
<pre><code class="javascript">var React = require('react');
var ReactDOM = require('react-dom');
var style = require('./app.css');

ReactDOM.render(
  &lt;div&gt;
    &lt;h1 className={style.h1}&gt;Hello World&lt;/h1&gt;
    &lt;h2 className="h2"&gt;Hello Webpack&lt;/h2&gt;
  &lt;/div&gt;,
  document.getElementById('example')
);</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">module.exports = {
  entry: './main.jsx',
  output: {
    filename: 'bundle.js'
  },
  module: {
    loaders:[
      {
        test: /\.js[x]?$/,
        exclude: /node_modules/,
        loader: 'babel-loader',
        query: {
          presets: ['es2015', 'react']
        }
      },
      {
        test: /\.css$/,
        loader: 'style-loader!css-loader?modules'
      }
    ]
  }
};</code></pre>
<p>启动服务.</p>
<pre><code>$ webpack-dev-server</code></pre>
<p>访问 <a href="http://127.0.0.1:8080">http://127.0.0.1:8080</a> , 你将看到只有第二个 <code>h1</code> 是红的,因为它是局部, 同时 <code>h2</code> 是蓝色的, 因为是<code>h2</code>全局的.</p>
<h2>Demo07: UglifyJs Plugin (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo07">源码</a>)</h2>
<p>Webpack 可以去掉本身附加的东西，优化代码 <a href="http://webpack.github.io/docs/list-of-plugins.html#uglifyjsplugin">UglifyJs Plugin</a> will minify output(<code>bundle.js</code>) JS codes.</p>
<p>main.js</p>
<pre><code class="javascript">var longVariableName = 'Hello';
longVariableName += ' World';
document.write('&lt;h1&gt;' + longVariableName + '&lt;/h1&gt;');</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
&lt;body&gt;
  &lt;script src="bundle.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">var webpack = require('webpack');
var uglifyJsPlugin = webpack.optimize.UglifyJsPlugin;
module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  },
  plugins: [
    new uglifyJsPlugin({
      compress: {
        warnings: false
      }
    })
  ]
};</code></pre>
<p>启动服务后, <code>main.js</code> 将会压缩如下.</p>
<pre><code class="javascript">var o="Hello";o+=" World",document.write("&lt;h1&gt;"+o+"&lt;/h1&gt;")</code></pre>
<h2>Demo08: HTML Webpack Plugin and Open Browser Webpack Plugin (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo08">源码</a>)</h2>
<p>这个例子需要加载三个插件</p>
<p><a href="https://github.com/ampedandwired/html-webpack-plugin">html-webpack-plugin</a> 创建 <code>index.html</code> ，<a href="https://github.com/baldore/open-browser-webpack-plugin">open-browser-webpack-plugin</a> 打开浏览器</p>
<p>main.js</p>
<pre><code class="javascript">document.write('&lt;h1&gt;Hello World&lt;/h1&gt;');</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">var HtmlwebpackPlugin = require('html-webpack-plugin');
var OpenBrowserPlugin = require('open-browser-webpack-plugin');

module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  },
  plugins: [
    new HtmlwebpackPlugin({
      title: 'Webpack-demos',
      filename: 'index.html'
    }),
    new OpenBrowserPlugin({
      url: 'http://localhost:8080'
    })
  ]
};</code></pre>
<p>启动 <code>webpack-dev-server</code>.启动这个需要node7版本以上</p>
<pre><code>$ webpack-dev-server</code></pre>
<p>不用手写<code>index.html</code> 也不用手动打开浏览器 Webpack 可以为你做这些事.</p>
<h2>Demo09: 设置环境变量(<a href="https://github.com/holidaying/webpack-demos/tree/master/demo09">源码</a>)</h2>
<p>你可以利用环境变量来控制特定代码的输出</p>
<p>main.js</p>
<pre><code class="javascript">document.write('&lt;h1&gt;Hello World&lt;/h1&gt;');

if (__DEV__) {
  document.write(new Date());
}</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
&lt;body&gt;
  &lt;script src="bundle.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">var webpack = require('webpack');

var devFlagPlugin = new webpack.DefinePlugin({
  __DEV__: JSON.stringify(JSON.parse(process.env.DEBUG || 'false'))
});

module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  },
  plugins: [devFlagPlugin]
};</code></pre>
<pre><code># Linux &amp; Mac
$ env DEBUG=true webpack-dev-server

# Windows
$ set DEBUG=true
$ webpack-dev-server</code></pre>
<h2>Demo10: Code splitting (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo10">源码</a>)</h2>
<p>对于大型项目，把所有代码编译到一个文件并不是有效的, Webpack 允许你把代码分成好多块. 特别是某种情况下，只需要个别代码这些块可以按需加载。<br>在commonjs中有一个Modules/Async/A规范，里面定义了require.ensure语法。webpack实现了它，作用是可以在打包的时候进行代码分片，并异步加载分片后的代码。用法如下：<br>require.ensure([], function(require){</p>
<pre><code>var list = require('./list');
list.show();</code></pre>
<p>});<br>此时list.js会被打包成一个单独的chunk文件，大概长这样：<br>1.fb874860b35831bc96a8.js<br>可读性比较差。我在上一篇结尾也提到了，给它命名的方式，那就是给require.ensure传递第三个参数，如：</p>
<p>require.ensure([], function(require){</p>
<pre><code>var list = require('./list');
list.show();</code></pre>
<p>}, 'list');<br>这样就能得到你想要的文件名称：<br>首先，你需要用 <code>require.ensure</code> to 来定义一个分割的点. (<a href="http://webpack.github.io/docs/code-splitting.html">官方文档</a>)</p>
<pre><code class="javascript">// main.js
require.ensure(['./a'], function(require) {
  var content = require('./a');
  document.open();
  document.write('&lt;h1&gt;' + content + '&lt;/h1&gt;');
  document.close();
});</code></pre>
<p><code>require.ensure</code> 告诉 Webpack  <code>./a.js</code> 应该从 <code>bundle.js</code> 中分离成一个单独的块</p>
<pre><code class="javascript">// a.js
module.exports = 'Hello World';</code></pre>
<p>Now Webpack takes care of the dependencies, output files and runtime stuff. You don't have to put any redundancy into your <code>index.html</code> and <code>webpack.config.js</code>.</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;script src="bundle.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">module.exports = {
  entry: './main.js',
  output: {
    filename: 'bundle.js'
  }
};</code></pre>
<p>地洞服务.</p>
<pre><code>$ webpack-dev-server</code></pre>
<p>在界面上, 你感觉不到任何不一样的地方. 但是, Webpack 已经把 <code>main.js</code> 和 <code>a.js</code> 编译成(<code>bundle.js</code> 和 <code>1.bundle.js</code>)的块。</p>
<h2>Demo11: 通过bundle-loader进行代码分裂 (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo11">源码</a>)</h2>
<p>dem10是一种，另一种是利用<a href="https://www.npmjs.com/package/bundle-loader">bundle-loader</a>.</p>
<pre><code class="javascript">// main.js

// Now a.js is requested, it will be bundled into another file
var load = require('bundle-loader!./a.js');

// To wait until a.js is available (and get the exports)
//  you need to async wait for it.
load(function(file) {
  document.open();
  document.write('&lt;h1&gt;' + file + '&lt;/h1&gt;');
  document.close();
});</code></pre>
<p><code>require('bundle-loader!./a.js')</code> tells Webpack to load <code>a.js</code> from another chunk.</p>
<p>Now Webpack will build <code>main.js</code> into <code>bundle.js</code>, and <code>a.js</code> into <code>1.bundle.js</code>.</p>
<h2>Demo12: Common chunk (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo12">源码</a>)</h2>
<p>利用webpack.optimize.CommonsChunkPlugin，你可以共通的组件，代码块分离出来</p>
<pre><code class="javascript">// main1.jsx
var React = require('react');
var ReactDOM = require('react-dom');

ReactDOM.render(
  &lt;h1&gt;Hello World&lt;/h1&gt;,
  document.getElementById('a')
);

// main2.jsx
var React = require('react');
var ReactDOM = require('react-dom');

ReactDOM.render(
  &lt;h2&gt;Hello Webpack&lt;/h2&gt;,
  document.getElementById('b')
);</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;div id="a"&gt;&lt;/div&gt;
    &lt;div id="b"&gt;&lt;/div&gt;
    &lt;script src="init.js"&gt;&lt;/script&gt;
    &lt;script src="bundle1.js"&gt;&lt;/script&gt;
    &lt;script src="bundle2.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">var CommonsChunkPlugin = require("webpack/lib/optimize/CommonsChunkPlugin");
module.exports = {
  entry: {
    bundle1: './main1.jsx',
    bundle2: './main2.jsx'
  },
  output: {
    filename: '[name].js'
  },
  module: {
    loaders:[
      {
        test: /\.js[x]?$/,
        exclude: /node_modules/,
        loader: 'babel-loader',
        query: {
          presets: ['es2015', 'react']
        }
      },
    ]
  },
  plugins: [
    new CommonsChunkPlugin('init.js')
  ]
}</code></pre>
<h2>Demo13: Vendor chunk (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo13">源码</a>)</h2>
<p>利用ebpack.optimize.CommonsChunkPlugin，你可以把第三方库抽离出来</p>
<p>main.js</p>
<pre><code class="javascript">var $ = require('jquery');
$('h1').text('Hello World');</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;h1&gt;&lt;/h1&gt;
    &lt;script src="vendor.js"&gt;&lt;/script&gt;
    &lt;script src="bundle.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>webpack.config.js</p>
<pre><code class="javascript">var webpack = require('webpack');

module.exports = {
  entry: {
    app: './main.js',
    vendor: ['jquery'],
  },
  output: {
    filename: 'bundle.js'
  },
  plugins: [
    new webpack.optimize.CommonsChunkPlugin(/* chunkName= */'vendor', /* filename= */'vendor.js')
  ]
};</code></pre>
<p>If you want a module available as variable in every module, such as making $ and jQuery available in every module without writing <code>require("jquery")</code>. You should use <code>ProvidePlugin</code> (<a href="http://webpack.github.io/docs/shimming-modules.html">官方文档</a>).</p>
<pre><code class="javascript">// main.js
$('h1').text('Hello World');


// webpack.config.js
var webpack = require('webpack');

module.exports = {
  entry: {
    app: './main.js'
  },
  output: {
    filename: 'bundle.js'
  },
  plugins: [
    new webpack.ProvidePlugin({
      $: "jquery",
      jQuery: "jquery",
      "window.jQuery": "jquery"
    })
  ]
};</code></pre>
<p>插件会执行两次这个方法，第一次将公共的第三方代码抽离移到vendor的块中，这个过程之前也讲过会将运行时runtime也转移到vendor块中，第二次执行则是将运行时runtime抽离出来转移到manifest块中。这步操作解决了缓存问题。<br>这样处理，最后会生成3个打包文件chunk，app.js是业务代码，vendor则是公共的第三方代码，manifest.js则是运行时。</p>
<h2>Demo14: Exposing global variables (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo14">源码</a>)</h2>
<p>webpack可以不处理应用的某些依赖库，使用externals配置后，依旧可以在代码中通过CMD、AMD或者window/global全局的方式访问。如果你想引入一些全局变量, 但是不想被加载处理, 你可以在 <code>webpack.config.js</code> 使用 <code>externals</code> 模块 (<a href="http://webpack.github.io/docs/library-and-externals.html">官方文档</a>).<br>有时我们希望我们通过script引入的库，如用CDN的方式引入的jquery，我们在使用时，依旧用require的方式来使用，但是却不希望webpack将它又编译进文件中。<br>&lt;script src="<a href="http://code.jquery.com/jquery-1.12.0.min.js%22&gt;&lt;/script&gt;">http://code.jquery.com/jquery...</a><br>例子, <code>data.js</code>.</p>
<pre><code class="javascript">var data = 'Hello World';</code></pre>
<p>We can expose <code>data</code> as a global variable.</p>
<pre><code class="javascript">// webpack.config.js
module.exports = {
  entry: './main.jsx',
  output: {
    filename: 'bundle.js'
  },
  module: {
    loaders:[
      {
        test: /\.js[x]?$/,
        exclude: /node_modules/,
        loader: 'babel-loader',
        query: {
          presets: ['es2015', 'react']
        }
      },
    ]
  },
  externals: {
    // require('data') is external and available
    //  on the global var data
    'data': 'data'
  }
};</code></pre>
<p>现在, 你可以require <code>data</code> 作为模块化引入进来使用. 但是实际上是一个全局变量</p>
<pre><code class="javascript">// main.jsx
var data = require('data');
var React = require('react');
var ReactDOM = require('react-dom');

ReactDOM.render(
  &lt;h1&gt;{data}&lt;/h1&gt;,
  document.body
);</code></pre>
<h2>Demo15: 热模块替换/热更新 (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo15">源码</a>)</h2>
<p><a href="https://github.com/webpack/docs/wiki/hot-module-replacement-with-webpack">Hot Module Replacement</a> (HMR) exchanges, adds, or removes modules while an application is running <strong>without a page reload</strong>.</p>
<p>通过webpack-dev-server.你可以使用<a href="http://webpack.github.io/docs/webpack-dev-server.html#hot-module-replacement">2中方式</a> 来进行热模块替换</p>
<p>(1) Specify <code>--hot</code> and <code>--inline</code> on the command line</p>
<pre><code>$ webpack-dev-server --hot --inline</code></pre>
<p>参数的意思:</p>
<ul>
<li><p><code>--hot</code>: adds the HotModuleReplacementPlugin and switch the server to hot mode.</p></li>
<li><p><code>--inline</code>: embed the webpack-dev-server runtime into the bundle.</p></li>
<li><p><code>--hot --inline</code>: also adds the webpack/hot/dev-server entry.</p></li>
</ul>
<p>(2) 修改 <code>webpack.config.js</code>.</p>
<ul>
<li><p>添加 <code>new webpack.HotModuleReplacementPlugin()</code> to the <code>plugins</code> 模块</p></li>
<li><p>添加 <code>webpack/hot/dev-server</code> 和 <code>webpack-dev-server/client?http://localhost:8080</code> to the <code>entry</code> 模块</p></li>
</ul>
<p><code>webpack.config.js</code> 如下所示.</p>
<pre><code class="javascript">var webpack = require('webpack');
var path = require('path');

module.exports = {
  entry: [
    'webpack/hot/dev-server',
    'webpack-dev-server/client?http://localhost:8080',
    './index.js'
  ],
  output: {
    filename: 'bundle.js',
    publicPath: '/static/'
  },
  plugins: [
    new webpack.HotModuleReplacementPlugin()
  ],
  module: {
    loaders: [{
      test: /\.jsx?$/,
      exclude: /node_modules/,
      loader: 'babel-loader',
      query: {
        presets: ['es2015', 'react']
      },
      include: path.join(__dirname, '.')
    }]
  }
};</code></pre>
<p>启动服务</p>
<pre><code>$ webpack-dev-server</code></pre>
<p>访问 <a href="http://localhost:8080,">http://localhost:8080,</a> 你可以在浏览器上看到 'Hello World' .</p>
<p>不要关闭服务.打开终端找到 <code>App.js</code>, 同时修改 'Hello World' 为 'Hello Webpack'. 保存后，你就可以在浏览器上看到数据更新了</p>
<p>App.js</p>
<pre><code class="javascript">import React, { Component } from 'react';

export default class App extends Component {
  render() {
    return (
      &lt;h1&gt;Hello World&lt;/h1&gt;
    );
  }
}</code></pre>
<p>index.js</p>
<pre><code class="javascript">import React from 'react';
import ReactDOM from 'react-dom';
import App from './App';

ReactDOM.render(&lt;App /&gt;, document.getElementById('root'));</code></pre>
<p>index.html</p>
<pre><code class="html">&lt;html&gt;
  &lt;body&gt;
    &lt;div id='root'&gt;&lt;/div&gt;
    &lt;script src="/static/bundle.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<h2>Demo16: React router例子 (<a href="https://github.com/holidaying/webpack-demos/tree/master/demo16">源码</a>)</h2>
<p>利用webpack做的例子 <a href="https://github.com/rackt/react-router/blob/0.13.x/docs/guides/overview.md">React-router</a>'s 官方例子.</p>
<p>Let's imagine a little app with a dashboard, inbox, and calendar.</p>
<pre><code>+---------------------------------------------------------+
| +---------+ +-------+ +--------+                        |
| |Dashboard| | Inbox | |Calendar|      Logged in as Jane |
| +---------+ +-------+ +--------+                        |
+---------------------------------------------------------+
|                                                         |
|                        Dashboard                        |
|                                                         |
|                                                         |
|   +---------------------+    +----------------------+   |
|   |                     |    |                      |   |
|   | +              +    |    +---------&gt;            |   |
|   | |              |    |    |                      |   |
|   | |   +          |    |    +-------------&gt;        |   |
|   | |   |    +     |    |    |                      |   |
|   | |   |    |     |    |    |                      |   |
|   +-+---+----+-----+----+    +----------------------+   |
|                                                         |
+---------------------------------------------------------+</code></pre>
<pre><code>$ webpack-dev-server --history-api-fallback</code></pre>
<h2>参照文档</h2>
<ul>
<li><p><a href="http://webpack.github.io/docs/">Webpack docs</a></p></li>
<li><p><a href="https://github.com/petehunt/webpack-howto">webpack-howto</a>, by Pete Hunt</p></li>
<li><p><a href="https://web-design-weekly.com/2014/09/24/diving-webpack/">Diving into Webpack</a>, by Web Design Weekly</p></li>
<li><p><a href="http://www.christianalfoni.com/articles/2014_12_13_Webpack-and-react-is-awesome">Webpack and React is awesome</a>, by Christian Alfoni</p></li>
<li><p><a href="https://medium.com/@housecor/browserify-vs-webpack-b3d7ca08a0a9">Browserify vs Webpack</a>, by Cory House</p></li>
<li><p><a href="https://christianalfoni.github.io/react-webpack-cookbook/index.html">React Webpack cookbook</a>, by Christian Alfoni</p></li>
</ul>
<p><a href="https://github.com/holidaying/ui-home/wiki">免费送上UI资源库</a></p>
<blockquote><p>全文参考阮老师的教程。</p