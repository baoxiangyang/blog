相的磨合与学习，希望身边的人可以有自己的经验分享，与理解，互相进步才是大家需要的，作为一个 "年老" (我也是90后) 的开发者，我觉得一代胜一代，未来才有胜算。额，好了，我不充当老师的角色了，去正题。</p>
<h2>1. 安卓中 a 标签的坑</h2>
<p>在和客户端交互的过程中，往往都有跳转的，而在咱们 Web 开发中，默认的 <code>href</code> 属性通常是 <code>#</code>，然后通过获取标签绑定动作触发事件，这里有个坑，在与安卓交互过程中会发现。</p>
<pre><code class="html">&lt;a href="#"&gt;click me&lt;/a&gt;
// include zepto or jquery or other.
$(function () {
    $('a').on('tap, click', function () {
        alert('test');
        return false;
    });
});</code></pre>
<p>上述代码中，会引起安卓交互中的一个坑，就是没点击一次，安卓都会在计数器上+1, 也就是，点击第一次，弹一次窗，点击第二次，会弹两次窗，如此类推。</p>
<p>解决方法:</p>
<pre><code class="html">&lt;a href="javascript:void(0);"&gt;click me&lt;/a&gt;</code></pre>
<p>Fxied!!</p>
<h2>2. 安卓中交互的坑</h2>
<p>我丢，安卓这个坑爹，在 <code>js</code> 交互中，无法传递对象，匿名函数等等的类型。也就是说，如果你的参数是接受一个对象的，你必须将她转成 <code>String</code>，而且安卓中的返回值也是只能返回 <code>String</code>，在咱们接受之后需要将字符串转换成对象。</p>
<p><strong> 简单 </strong>判断客户端类型的:</p>
<pre><code class="javascript">isiOS: function () {
     if (this.ua.match(/android/i) == "android") {
         return false;
     }
     return true;
 },
 isAndroid: function () {
     if (this.ua.match(/android/i) == "android") {
         return true;
     }
     return false;
 }</code></pre>
<p>解决方法:</p>
<pre><code class="javascript">encode: function (data) {
     if ("" == data) {
         return {};
     }
     return JSON.stringify(data).replace(/"/g, '\'');
 },
 decode: function (data) {
     if ("" == data) {
         return "{}";
     }
     return JSON.parse(data.replace(/\'/ig,'\"'));
 }</code></pre>
<p>在调用 iOS 或者 android 的时候，先将参数传递到 encode 处进行过滤。</p>
<h2>3. 判断页面是否在应用内打开</h2>
<p>其实这个很简单，经常做 web 开发的都应该知道，咱们每天都与 Http 协议打交道，而在 Http 中，有一个很重的的标识，就是 User-Agent，简称 UA，其实这个东西就像咱们的门票一样，有着各种的信息在上面，其实就包括了很多的浏览器内核信息，版本信息，厂商等等......咱们就是从这个地方入手，在客户端中定义自己的版本信息，与微信一样。从此告别什么 url 上加什么破参数啊什么的。</p>
<p>以我的经验来设计的话，一般按照这个格式： </p>
<p><code>Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_2_1 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5 {company} {appname} [{type}]/{version}</code></p>
<p>如： 腾讯，微信 [海外版本] 6.0.0</p>
<p><code>Mozilla/5.0 (iPhone; U; CPU iPhone OS 4_2_1 like Mac OS X; en-us) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5 Tencent MicroMessager oversase/6.0.0</code></p>
<p>因为此处我还没太多接触客户端开发，暂时没有客户端代码演示.</p>
<pre><code class="javascript">us: window.navigator.userAgent.toLowerCase(),
is: function (name) {
    return tools.ua.match(eval("/" + name + "/i")) == name ? true : false;
}</code></pre>
<p>Examples:</p>
<pre><code class="javascript">if (/* Is app inside */) {
    /* Operation */
} else {
    /* Is app outside */
    /* Operation */
}</code></pre>
<p>Combine: In wechat</p>
<pre><code class="javascript">if (/* In wechat app */) {
    /* open share guide */
} else {
    if (/* In app */) {
        if (/* Is iOS */) {
            /* share iOS sdk */
        } else {
            /* share android sdk */
        }
    } else {
        /* share operation */
    }
}</code></pre>
<h2>4. 请善用你的 Http Status Code</h2>
<p>曾几何时，我也是一个懵懂无知的骚年，连接口是干嘛用的都不知道，大概也在 2014/8 月份左右，我对接口都是一种很敬畏的眼光去看待，直到现在，2016年，我更加视接口是一切数据库的来源，其价值是最至高无上的。但是由我接触接口(Application Programing Interface)开发之后，我发现目前的接口有好多问题，一个很明显的就是，为啥每个接口都是 200，不应该啊，那非 200 响应的应该怎么办？有做处理吗？<br>直到后来，我推翻了这一现象，也说服了各方的人。我举一个 <code>Ajax</code> 的例子：</p>
<p>首先我先问一个问题，为何 jquery 和 zepto 的 ajax 中，都有一个 <code>error</code> 回调？</p>
<pre><code class="javascript">$.ajax({
    // some code
    success: function () {},
    error: function () {}
});</code></pre>
<p>请不要怀疑设计者的智商与知识，我猜他应该会比你聪明以及牛叉。这么做，肯定有原因的。其实这里的 <code>error</code> 就是为了让非 2xx 状态的时候进入的操作的。</p>
<p>如示例：</p>
<pre><code class="json">{
    status: 1
    content: {}
}</code></pre>
<p><strong> 以上例子本身没有错误，仅以自己看法对上述进行评述 </strong></p>
<p>其实咱们应该要善用本身已经有的东西，不需要再重新造多一个，吃力不讨好，那你们就开始好好补一补 Http Status code 相关的知识吧。</p>
<p>示例：</p>
<pre><code>Request Method:GET
Status Code:200 OK</code></pre>
<p><code>200</code> 一般都是成功响应，<br><code>3xx</code> <br><code>4xx</code><br><code>5xx</code></p>
<p>根据不同的状态码进行不同的处理机制，无需重复再做这一步骤了，其实设计者也很清晰设计出状态码的意义，应该善用。</p>
<h2>5. 判断应用是否安装，如果安装，则打开，否则则跳去下载</h2>
<p>其实这个有点无理取闹，但是又不得不去做，首先这个其实原理也是挺绕的</p>
<ol>
<li><p>利用iframe尝试打开自定义scheme</p></li>
<li><p>跳转到下载地址</p></li>
</ol>
<p>只是那个判断......</p>
<p>其实我是建议这些操作统一由一个地方去做，比如定义一个域名叫: down.xxx.com/应用id，后台读取应用id 相信信息，统一由一处转发。</p>
<pre><code class="javascript">function open () {
    var ifr = document.createElement('iframe');
   ifr.src = url;
   ifr.style.display = 'none';
   document.body.appendChild(ifr);
   window.setTimeout(function(){
       document.body.removeChild(ifr);
   }, 3000);
}</code></pre>
<p><strong> 注意 iOS9 对这个有点不兼容，所以，谨慎，iOS7，iOS8，安卓均可以实现 </strong></p>
<p>获取版本信息:</p>
<pre><code class="javascript">var getVersion = function () {
  if (tools.client.isAndroid()) {
      return parseFloat(tools.ua.match(/Android\s(.*?);/i)[1]);
  }

  return parseFloat(tools.ua.match(/OS\s(.*?)\slike/i)[1].split('_').join('.'));
};</code></pre>
<p>这里需要判断系统类型及版本：</p>
<pre><code class="javascript">if (/* iOS */) {
    if (/* iOS version less than 9.0 */) {
        /* try open scheme */
        /* redirect download link */
    } else {
        /* other operate */
    }
} else {
    /* try open url */
    /* redirect download link */
}</code></pre>
<p>所以，由此可见其实这里的判断会很多，很多，很多。所以我墙裂建议都统一到一个地方做分发。</p>
<p>这里其实还需要判断是否微信，是否应用内打开，是否是分享出去的。</p>
<p>结合第 3 点的例子想想，这里的 <code>if</code> ...... 其实还是很恐怖的，我已经无